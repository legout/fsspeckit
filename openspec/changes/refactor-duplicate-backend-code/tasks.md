## 1. Analysis
- [ ] 1.1 Identify all duplicated code patterns between backends
- [ ] 1.2 Design shared utilities structure
- [ ] 1.3 Plan abstract base class design

## 2. Implementation
- [ ] 2.1 Extract common merge logic into `fsspeckit.core.merge`
- [ ] 2.2 Create abstract base class `BaseDatasetHandler`
- [ ] 2.3 Refactor duplicate compaction logic into shared functions
- [ ] 2.4 Refactor duplicate optimization logic into shared functions
- [ ] 2.5 Standardize error handling patterns
- [ ] 2.6 Eliminate code duplication in deduplication implementations

## 3. Testing
- [ ] 3.1 Ensure all functionality works after refactoring
- [ ] 3.2 Test both backends work identically
- [ ] 3.3 Validate no regressions in existing functionality
